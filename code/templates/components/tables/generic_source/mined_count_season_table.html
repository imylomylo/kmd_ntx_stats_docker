{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="row col-12 m-auto" id="mining_season">
    <div class="card table_card">
        <div class="card-header table_card_title">
            Source: Mined Count Season
        </div>
        <div class="card-body table_card_body">
            <table id="mining_season_tbl" class="table table-striped table-bordered m-auto" style="width:99%; visibility: hidden;" data-ajax="{% url 'minedCountSeasonViewSet-list' %}?format=datatables">
                <thead>
                    <tr>
                        <th data-data="name">Name</th>
                        <th data-data="blocks_mined">Blocks Mined</th>
                        <th data-data="sum_value_mined">Sum Mined</th>
                        <th data-data="max_value_mined">Biggest Block</th>
                        <th data-data="last_mined_block">Last Block</th>
                        <th data-data="last_mined_blocktime">Last Block Time</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function() {
        $('#mining_season_tbl').css('visibility', 'visible');
        $('#mining_season_tbl').DataTable({
            "paging": false,
            deferRender: true,
            "orderClasses": false,
            order: [[ 5, 'desc' ], [ 0, 'asc' ]],
            "columnDefs": [
                { className: "text-left text-nowrap", "targets": [ 0 ] },
                { className: "text-right text-nowrap", "targets": [ 2,3,5 ] },
                {
                    "targets": 4,
                    "data": "last_mined_block",
                    "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
                        $(nTd).html(get_block_url("KMD", oData.last_mined_block))
                    }
                },
                {
                    "targets": 5,
                    "data": "last_mined_blocktime",
                    "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
                        $(nTd).html(get_time_since(oData.last_mined_blocktime))
                    }
                }
            ]
        });
    });
</script>
{% endblock %}