{% extends "base.html" %}
{% load static %}
{% block content %}
{% load mathfilters %}
	<div class="row col-12 m-auto">
		<div class="card table_card">
			<div class="card-header table_card_title flex">
				<a href="../seednode_version_stats_month" class="icon-href h5"><i class="fas fa-search-minus"></i></a>
				<span class="mx-1">{{ season_clean }} MM2 Version Daily Stats</span>
				<a href="../seednode_version_stats_hourly" class="icon-href h5"><i class="fas fa-search-plus"></i></a>
				
				<br />
				<span style="font-size: 1rem;">
					<a href="?start={{ prev_ts }}" class="icon-href"><i class="fas fa-arrow-alt-circle-left"></i></a>
					<span class="mx-1">{{ from_date }} to {{ to_date }}</span>
					<a href="?start={{ next_ts }}" class="icon-href"><i class="fas fa-arrow-alt-circle-right"></i></a>
				</span>
			</div>
			<div class="card-body table_card_body" style="overflow-x: scroll;">
				<table id="mm2_version_tbl" class="table table-striped table-bordered">
					<thead>
						<tr>
							{% for header in headers %}		
								<th style="font-size: 0.7rem;">{{ header }}</th>
							{% endfor %}
						</tr>
					</thead>
					<tbody>
					{% for notary, score_list in scores.items %}
						<tr>
							<td data-data="notary">{{ notary }}</td>
							{% for score in score_list %}
								{% if score > 0 %}
									<td style="background-color: #104d1b;">{{ score }}</td>
								{% else %}
									<td>{{ score }}</td>
								{% endif %}
							{% endfor %}
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
			<div class="card-footer flex">
				<i>Times are in UTC.</i><br />
				The current active mm2 version: {{ active_version }}
			</div>
		</div>
	</div>
	
	<script>

		{% autoescape off %}

		$('#start').val(local_date_str('{{start_str}}'))
		$('#end').val(local_date_str('{{end_str}}'))
		{% endautoescape %}
		$(document).ready(function() {
	        $('#mm2_version_tbl').DataTable({
    			deferRender: true,
                "orderClasses": false,
    			"paging": false,
  				"pageLength": 50,
        		order: [[ 0, 'asc' ]],
        		"columnDefs": [
		            { orderable: true, className: 'reorder', targets: 0 },
		            { orderable: true, className: 'reorder', targets: $('#mm2_version_tbl').find('th').length - 1 },
		            { orderable: false, targets: '_all' }
			    ],
                // Custom DataTables search filter input styling
				"initComplete": function (settings, json) {
	            }
	        });
	        console.log($('#mm2_version_tbl').find('th').length - 1)
	    });

	</script>
{% endblock %}
