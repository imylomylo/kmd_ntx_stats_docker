{% extends "base.html" %}
{% load static %}
{% block content %}

				<div class="row my-3">
					<div class="card-deck d-flex justify-content-between col-12 m-auto">
						<div class="card kmd_ui_light4">
							<div class="card-body kmd_ui_dark1_bg">
								<h3>{{ notary }} {{ season }} Epoch Chain Scoring</h3>
								<h5>Total score: {{ total|floatformat:-3 }}</h5>
								<table id="epoch_scoring_table" class="table table-striped table-bordered kmd_ui_light4 m-auto" style="width:99%">
									<thead>
										<tr>
											<th data-data="server">Server</th>
											<th data-data="epoch">Epoch</th>
											<th data-data="chain">Chain</th>
											<th data-data="epoch_chain_ntx_count">NTX Count</th>
											<th data-data="score_per_ntx">Per NTX</th>
											<th data-data="epoch_chain_score">Score</th>
										</tr>
									</thead>
									<tbody>
										{% for row in scoring_table %}
										<tr>
											<td data-data="server">{{ row.server }}</th>
											<td data-data="epoch">{{ row.epoch }}</th>
											<td data-data="chain">{{ row.chain }}</th>
											{% if row.server == 'BTC' %}
												<td data-data="epoch_chain_ntx_count">{{ row.epoch_chain_ntx_count }} <a style="font-size: 0.9em;" href="//{{ request.get_host }}/api/info/notarisation/?notary={{ notary }}&chain={{ row.chain }}&season={{ season }}&epoch=Epoch_{{ row.epoch }}&server=Main">[tx]</a></th>
											{% else %}
												<td data-data="epoch_chain_ntx_count">{{ row.epoch_chain_ntx_count }} <a style="font-size: 0.9em;" href="//{{ request.get_host }}/api/info/notarisation/?notary={{ notary }}&chain={{ row.chain }}&season={{ season }}&epoch=Epoch_{{ row.epoch }}&server={{ row.server }}">[tx]</a></th>
											{% endif %}
											<td data-data="score_per_ntx">{{ row.score_per_ntx }}</th>
											<td data-data="epoch_chain_score">{{ row.epoch_chain_score|floatformat:-3 }}</th>
										</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						</div>	
					</div>
				</div>
    <!-- jquery -->
  
  	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> 
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    {{ explorers|json_script:"explorers-data" }}
  	<script>
	    $(document).ready(function() {
	    	var explorers = JSON.parse(document.getElementById('explorers-data').textContent);
	        AR_table = $('#epoch_scoring_table').DataTable({
	        	"paging": false,
        		order: [[ 0, 'asc' ],[ 1, 'asc' ],[ 2, 'asc' ]],
	        	"columns": [
			        { "data": "server" },
			        { "data": "epoch" },
			        { "data": "chain" },
			        { "data": "epoch_chain_ntx_count" },
			        { "data": "score_per_ntx" },
			        { "data": "epoch_chain_score" }
			    ],
        		"columnDefs": [
        		]
	        })
		});
    </script> 

{% endblock %}
