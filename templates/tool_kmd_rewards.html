{% extends "base.html" %}
{% load static %}
{% block content %}
	<div class="row col-12 mx-auto my-2" style="color:#FFF;">
		<div class="card m-auto">
			<div class="card-header col-12 m-auto">
				<h2>Komodo Active User Rewards</h2>
				<form>
				  <div class="input-group mb-3 kmd_ui_dark1_bg" style="min-width: 50em">
				    <div class="input-group-prepend p-0" >
				      <span class="input-group-text  kmd_ui_dark4_bg" style="color:white; border: solid grey 1px !important; line-height: 1em;">
				      	Enter KMD Address
				      </span>
				    </div>
				    <input type="text" class="form-control m-auto kmd_ui_dark3_bg" id="address_id" name="address" placeholder="{{ address }}"  style="border: solid grey 1px !important; font-size: 1em; line-height: 1em; text-align: center; min-width: 44em">
				    <div class="input-group-append p-0  kmd_ui_dark4_bg">
						<button class="btn btn-dark"style="line-height: 1em; border: solid grey 1px !important;">
						    Show Rewards
						</button>
				    </div>
				  </div>
				</form>
				{% if address %}
				<h6><b>Address:</b> <a href='https://komodod.com/a/{{ address }}'>{{ address }}</a></h6>
				<h6><b>Balance:</b> {{ kmd_balance }}</h6>
				<h6><b>UTXOs eligible:</b> {{ eligible_utxo_count }}/{{ utxo_count }}</h6>
				<div style="font-size: 1.2em; background-color:black; border: solid 1px grey" class="badge p-3">
					<b>Total rewards:</b> {{ total_rewards }} KMD
				</div>
				{% endif %}
			</div>
			{% if kmd_rewards_rows %}
			<div class="card-body m-auto col-12">

				<table id="opret_table" class="table table-striped table-bordered kmd_ui_light4">
					<thead>
						<tr>
							<th data-data="block_height">Block Height</th>
							<th data-data="txid">Transaction</th>
							<th data-data="utxo_value">UTXO Value</th>
							<th data-data="reward">Reward</th>
						</tr>
					</thead>
					<tbody>
						{% for item in kmd_rewards_rows %}
							<tr>
								<td style="font-size: 1.2em" data-data="block_height">{{ item.block_height }}</td>
								<td style="font-size: 1.2em" data-data="txid">{{ item.txid }}</td>
								<td style="font-size: 1.2em" data-data="utxo_value">{{ item.utxo_value }}</td>
								<td style="font-size: 1.2em" data-data="reward">{{ item.kmd_rewards }}</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			{% endif %}
		</div>	
	</div>
    <!-- jquery -->
  
  	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> 
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  	
  	<script>
	    $(document).ready(function() {
	        $('#opret_table').DataTable({  "pageLength": 50,
        		order: [[ 0, 'asc' ]],
	        	"columns": [
			        { "data": "block_height" },
			        { "data": "txid" },
			        { "data": "amount" },
			        { "data": "reward" }
			    ],
        		"columnDefs": [
        			{
			            "targets": 0,
			            "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
				            $(nTd).html("<span class='badge kmd_ui_dark1_bg p-2'><a href='https://komodod.com/b/"+oData.block_height+"'>"+oData.block_height+"</a></span>");
				        }
			        },
        			{
			            "targets": 1,
			            "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
				            $(nTd).html("<span class='badge kmd_ui_dark1_bg p-2'><a href='https://komodod.com/t/"+oData.txid+"'>"+oData.txid+"</a></span>");
				        }
			        },
        			{
			            "targets": 2,
			            "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
				            $(nTd).html("<span class='badge kmd_ui_dark1_bg p-2'>"+oData.amount+"</span>");
				        }
			        },
        			{
			            "targets": 3,
			            "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
				            $(nTd).html("<span class='badge kmd_ui_dark1_bg p-2'>"+oData.reward+"</span>");
				        }
			        }
        		]
	        });
	    });
    </script> 
{% endblock %}
